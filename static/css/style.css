/* === Reset & Base === */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --color-bg: #f8f9fa;
  --color-surface: #fff;
  --color-text: #212529;
  --color-muted: #6c757d;
  --color-border: #dee2e6;
  --color-primary: #0d6efd;
  --color-primary-hover: #0a58ca;
  --color-danger: #dc3545;
  --color-danger-hover: #b02a37;
  --color-warning-bg: #fff3cd;
  --color-warning-text: #664d03;
  --color-ok-bg: #d1e7dd;
  --color-ok-text: #0f5132;
  --radius: 6px;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: var(--color-bg);
  color: var(--color-text);
  line-height: 1.5;
}

/* === Layout === */
header { background: var(--color-surface); border-bottom: 1px solid var(--color-border); }
nav {
  max-width: 1200px; margin: 0 auto; padding: 1rem 1.25rem;
  display: flex; align-items: center; justify-content: space-between;
}
.logo { font-weight: 700; font-size: 2.5rem; text-decoration: none; color: var(--color-text); }
.nav-left { display: flex; align-items: center; gap: 1.5rem; }
.nav-links { display: flex; align-items: center; gap: 1rem; }
.nav-link { text-decoration: none; color: var(--color-muted); font-size: 0.9375rem; }
.nav-link:hover { color: var(--color-text); }
main { max-width: 1200px; margin: 0 auto; padding: 2rem 1.25rem; }
h1 { margin-bottom: 1rem; font-size: 1.75rem; }

/* === Buttons === */
.btn {
  display: inline-block; padding: 0.5rem 1rem; border-radius: var(--radius);
  text-decoration: none; font-size: 0.9375rem; border: 1px solid var(--color-border);
  background: var(--color-surface); color: var(--color-text); cursor: pointer;
}
.btn:hover { background: var(--color-bg); }
.btn-primary { background: var(--color-primary); color: #fff; border-color: var(--color-primary); }
.btn-primary:hover { background: var(--color-primary-hover); border-color: var(--color-primary-hover); }
.btn-danger { background: var(--color-danger); color: #fff; border-color: var(--color-danger); }
.btn-danger:hover { background: var(--color-danger-hover); border-color: var(--color-danger-hover); }
.btn-sm { padding: 0.35rem 0.65rem; font-size: 0.8rem; }

/* === Filters === */
.filters { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; margin-bottom: 1rem; }
.category-tabs { display: flex; gap: 0.25rem; }
.tab {
  padding: 0.5rem 1rem; border-radius: var(--radius); text-decoration: none;
  font-size: 0.9375rem; color: var(--color-muted); border: 1px solid var(--color-border);
}
.tab:hover { background: var(--color-bg); color: var(--color-text); }
.tab.active { background: var(--color-primary); color: #fff; border-color: var(--color-primary); font-weight: 600; }
.search-input {
  padding: 0.5rem 0.85rem; border: 1px solid var(--color-border); border-radius: var(--radius);
  font-size: 0.9375rem; margin-left: auto; width: 260px;
}

/* === Sub-tabs (ingredient subcategories) === */
.sub-tabs { display: flex; gap: 0.25rem; margin-bottom: 1rem; }
.sub-tab {
  padding: 0.35rem 0.75rem; border-radius: var(--radius); text-decoration: none;
  font-size: 0.85rem; color: var(--color-muted); border: 1px solid transparent;
}
.sub-tab:hover { background: var(--color-bg); color: var(--color-text); }
.sub-tab.active { color: var(--color-primary); border-color: var(--color-primary); font-weight: 600; }

/* === Table === */
.item-table { width: 100%; border-collapse: collapse; background: var(--color-surface); border-radius: var(--radius); overflow: hidden; }
.item-table th, .item-table td { padding: 0.75rem 1rem; text-align: left; border-bottom: 1px solid var(--color-border); }
.item-table th { font-size: 0.85rem; text-transform: uppercase; color: var(--color-muted); font-weight: 600; white-space: nowrap; }
.sort-header { color: var(--color-muted); text-decoration: none; cursor: pointer; }
.sort-header:hover { color: var(--color-text); }
.sort-header.active { color: var(--color-text); font-weight: 700; }
.item-table td a { color: var(--color-primary); text-decoration: none; }
.item-table td a:hover { text-decoration: underline; }
.item-table .qty { font-variant-numeric: tabular-nums; }
.item-table .actions { white-space: nowrap; display: flex; gap: 0.25rem; }
tr.low-stock { background: var(--color-warning-bg); }
tr.reorder-stock { background: #f8d7da; }

/* === Badges === */
.badge {
  display: inline-block; padding: 0.2rem 0.6rem; border-radius: 999px;
  font-size: 0.8rem; font-weight: 600;
}
.badge-warning { background: transparent; color: var(--color-warning-text); border: 1px solid var(--color-warning-text); }
.badge-ok { background: var(--color-ok-bg); color: var(--color-ok-text); }
.badge-danger { background: transparent; color: #842029; border: 1px solid #842029; }

/* === Inline stock adjust === */
.adjust-row td { background: var(--color-bg); }
.inline-form { display: flex; align-items: center; gap: 0.5rem; }
.inline-form input { width: 100px; padding: 0.4rem 0.6rem; border: 1px solid var(--color-border); border-radius: var(--radius); }
.adjust-label { font-size: 0.875rem; }
.stock-preview { font-size: 0.875rem; font-weight: 600; }
.stock-preview .current-qty { color: var(--color-muted); }
.stock-preview .arrow { color: var(--color-muted); margin: 0 0.25rem; }
.stock-preview .new-qty { color: var(--color-primary); }

/* === Detail === */
.detail-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; }
.detail-actions { display: flex; gap: 0.5rem; }
.detail-card { background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius); padding: 1.5rem; margin-bottom: 1.5rem; }
.detail-card dl { display: grid; grid-template-columns: 160px 1fr; gap: 0.65rem 1.25rem; }
.detail-card dt { font-weight: 600; color: var(--color-muted); font-size: 0.9375rem; }

/* === Forms === */
.item-form { background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius); padding: 1.5rem; max-width: 700px; }
.form-group { margin-bottom: 1rem; }
.form-group label { display: block; font-weight: 600; font-size: 0.9375rem; margin-bottom: 0.25rem; }
.form-group input, .form-group select, .form-group textarea {
  width: 100%; padding: 0.5rem 0.75rem; border: 1px solid var(--color-border);
  border-radius: var(--radius); font-size: 0.9375rem; font-family: inherit;
}
.form-group textarea { resize: vertical; }
.form-group.has-error input, .form-group.has-error select, .form-group.has-error textarea { border-color: var(--color-danger); }
.help-text { font-size: 0.8rem; color: var(--color-muted); margin-top: 0.2rem; }
.error-text { font-size: 0.8rem; color: var(--color-danger); margin-top: 0.2rem; }
.form-actions { display: flex; gap: 0.5rem; margin-top: 1.25rem; }
.earmarked-field-row { display: flex; gap: 0.5rem; align-items: flex-start; }
#id_earmarked_for {
  flex: 1; padding: 0.5rem; margin: 0;
  border: 1px solid var(--color-border); border-radius: var(--radius);
  background: var(--color-surface); max-height: 150px; overflow-y: auto;
  list-style: none;
}
#id_earmarked_for li { padding: 0.25rem 0; }
#id_earmarked_for li label {
  display: flex; align-items: center; gap: 0.5rem;
  cursor: pointer; margin: 0; font-weight: normal;
}
#id_earmarked_for li input[type="checkbox"] { margin: 0; width: 1rem; height: 1rem; }
.quick-recipe-form { display: flex; gap: 0.5rem; align-items: center; margin-top: 0.5rem; }
.quick-recipe-form input[type="text"] {
  padding: 0.375rem 0.5rem; border: 1px solid var(--color-border);
  border-radius: var(--radius); font-size: 0.875rem;
}

/* === Form Row (side by side fields) === */
.form-row { display: flex; gap: 1rem; }
.form-row .form-group { flex: 1; }

/* === Fieldset / Formset === */
.ingredients-fieldset {
  border: 1px solid var(--color-border); border-radius: var(--radius);
  padding: 1rem; margin-top: 1rem;
}
.ingredients-fieldset legend {
  font-weight: 600; font-size: 0.9375rem; padding: 0 0.5rem;
}
.formset-table { width: 100%; border-collapse: collapse; }
.formset-table th {
  text-align: left; font-size: 0.8rem; text-transform: uppercase;
  color: var(--color-muted); font-weight: 600; padding: 0.5rem;
}
.formset-table td { padding: 0.5rem; }
.formset-table select, .formset-table input[type="number"] {
  width: 100%; padding: 0.4rem 0.5rem; border: 1px solid var(--color-border);
  border-radius: var(--radius); font-size: 0.875rem;
}
.formset-table .delete-cell { text-align: center; width: 60px; }

/* === Recipe Tooltip/Popup === */
.item-table { overflow: visible; }
#item-table-wrapper { padding-bottom: 12rem; margin-bottom: -10rem; }
.recipe-tooltip {
  position: relative; cursor: help;
  text-decoration: underline dotted; text-underline-offset: 2px;
}
.recipe-tooltip .recipe-popup {
  display: none; position: absolute; left: 0; top: 100%;
  z-index: 100; min-width: 250px; max-width: 350px;
  background: var(--color-surface); border: 1px solid var(--color-border);
  border-radius: var(--radius); box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  padding: 0.75rem; margin-top: 0.25rem;
}
.recipe-tooltip:hover .recipe-popup { display: block; }
.recipe-popup h4 { font-size: 0.9375rem; margin-bottom: 0.5rem; border-bottom: 1px solid var(--color-border); padding-bottom: 0.25rem; }
.recipe-popup .recipe-stats { display: flex; gap: 1rem; margin-bottom: 0.5rem; font-size: 0.8rem; color: var(--color-muted); }
.recipe-popup .recipe-stats span { font-weight: 600; color: var(--color-text); }
.recipe-popup .recipe-ingredients { font-size: 0.8rem; }
.recipe-popup .recipe-ingredients h5 { font-size: 0.75rem; text-transform: uppercase; color: var(--color-muted); margin: 0.5rem 0 0.25rem; }
.recipe-popup .recipe-ingredients ul { list-style: none; margin: 0; padding: 0; }
.recipe-popup .recipe-ingredients li { padding: 0.125rem 0; }
.recipe-popup .recipe-ingredients .amount { font-weight: 600; color: var(--color-danger); }

/* === Confirm === */
.confirm-card { background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius); padding: 1.5rem; max-width: 500px; }
.confirm-card p { margin-bottom: 1rem; }

/* === Empty state === */
.empty-state { text-align: center; padding: 3rem 1rem; color: var(--color-muted); }

/* === User Info === */
.user-info { color: var(--color-muted); font-size: 0.9375rem; }
